# Nginx 配置示例 - 添加到现有 server block 中
# 将此配置添加到你现有的 nginx 站点配置文件中

# 在现有的 server { ... } 块内添加以下 location:

location /seeder {
    proxy_pass http://127.0.0.1:38964;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;
    proxy_cache_bypass $http_upgrade;

    # SSE 支持 (Server-Sent Events)
    proxy_buffering off;
    proxy_read_timeout 86400s;
    proxy_send_timeout 86400s;
}

# 静态文件直接代理
location /seeder/_next/static {
    proxy_pass http://127.0.0.1:38964;
    proxy_http_version 1.1;
    proxy_set_header Host $host;
    proxy_cache_bypass $http_upgrade;

    # 静态文件缓存
    add_header Cache-Control "public, max-age=31536000, immutable";
}

# ============================================
# 完整配置示例（如果你需要新建站点）
# ============================================
#
# server {
#     listen 443 ssl http2;
#     server_name copilot.wildmeta.ai;
#
#     ssl_certificate /path/to/your/certificate.crt;
#     ssl_certificate_key /path/to/your/private.key;
#
#     # 其他现有的 location 配置...
#
#     # Seeder 应用
#     location /seeder {
#         proxy_pass http://127.0.0.1:38964;
#         proxy_http_version 1.1;
#         proxy_set_header Upgrade $http_upgrade;
#         proxy_set_header Connection 'upgrade';
#         proxy_set_header Host $host;
#         proxy_set_header X-Real-IP $remote_addr;
#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#         proxy_set_header X-Forwarded-Proto $scheme;
#         proxy_cache_bypass $http_upgrade;
#
#         # SSE 支持
#         proxy_buffering off;
#         proxy_read_timeout 86400s;
#         proxy_send_timeout 86400s;
#     }
#
#     location /seeder/_next/static {
#         proxy_pass http://127.0.0.1:38964;
#         proxy_http_version 1.1;
#         proxy_set_header Host $host;
#         add_header Cache-Control "public, max-age=31536000, immutable";
#     }
# }
